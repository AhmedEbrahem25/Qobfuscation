import qiskit
from qiskit import transpile
from qiskit_aer import AerSimulator
#test_circuit.py

def get_circuit():
    qc = qiskit.QuantumCircuit(3, 3, name='circuit-173_cloaked')

    qc.rz(1.5707963267948966, 0)
    qc.rx(1.5707963267948966, 0)
    qc.rz(1.5707963267948966, 0)
    qc.h(1)
    qc.h(1)
    qc.rz(1.5707963267948966, 1)
    qc.rx(1.5707963267948966, 1)
    qc.rz(1.5707963267948966, 1)
    qc.ry(1.5707963267948966, 2)
    qc.rz(3.141592653589793, 2)
    qc.h(2)
    qc.h(2)
    qc.h(2)
    qc.h(2)
    qc.p(1.5707963267948966, 2)
    qc.rz(1.5707963267948966, 2)
    qc.rx(1.5707963267948966, 2)
    qc.rz(1.5707963267948966, 2)
    qc.ry(1.5707963267948966, 2)
    qc.z(2)
    qc.ry(-1.5707963267948966, 2)
    qc.h(2)
    qc.sdg(2)
    qc.h(2)
    qc.ry(1.5707963267948966, 2)
    qc.h(2)
    qc.s(2)
    qc.s(2)
    qc.h(2)
    qc.ry(-1.5707963267948966, 2)
    qc.z(2)
    qc.ry(1.5707963267948966, 1)
    qc.rz(3.141592653589793, 1)
    qc.h(1)
    qc.h(1)
    qc.h(1)
    qc.h(1)
    qc.z(0)
    qc.cx(0, 1)
    qc.z(0)
    qc.rz(1.5707963267948966, 1)
    qc.rx(1.5707963267948966, 1)
    qc.rz(1.5707963267948966, 1)
    qc.cz(1, 2)
    qc.s(1)
    qc.x(1)
    qc.sdg(1)
    qc.rx(-1.5707963267948966, 1)
    qc.z(1)
    qc.rx(1.5707963267948966, 1)
    qc.h(0)
    qc.h(0)
    qc.h(0)
    qc.h(0)
    qc.h(0)
    qc.ry(-1.5707963267948966, 0)
    qc.x(0)
    qc.ry(1.5707963267948966, 0)
    qc.z(0)
    qc.h(0)
    qc.x(0)
    qc.h(0)
    qc.h(0)
    qc.rz(1.5707963267948966, 0)
    qc.tdg(0)
    qc.tdg(0)
    qc.rz(1.5707963267948966, 1)
    qc.rx(1.5707963267948966, 1)
    qc.rz(1.5707963267948966, 1)
    qc.ry(1.5707963267948966, 1)
    qc.rz(3.141592653589793, 1)
    qc.h(1)
    qc.x(2)
    qc.p(0.7853981633974483, 2)
    qc.s(2)
    qc.sdg(2)
    qc.p(-0.7853981633974483, 2)
    qc.measure(0, 0)
    qc.measure(1, 1)
    qc.measure(2, 2)

    return qc

qc = get_circuit()

simulator = AerSimulator()
print(qc.draw("text"))

compiled_circuit = transpile(qc, simulator)

job = simulator.run(compiled_circuit, shots=1024)

result = job.result()
counts = result.get_counts(compiled_circuit)

print("Simulation counts:", counts)

